<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script src="common.js"></script>


    <script src="https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
</head>

<body>

    <script type="text/javascript">  //趋势图并归
        var list = [{
                cycleTime: "2021-08-06 00:01:00",
                completeCount: 1,
                alarmCount: 2,
            },
            {
                cycleTime: "2021-08-06 00:01:00",
                completeCount: 1,
                alarmCount: 2,
            }, {
                cycleTime: "2021-08-06 00:01:00",
                completeCount: 1,
                alarmCount: 2,
            }, {
                cycleTime: "2021-08-06 00:01:00",
                completeCount: 1,
                alarmCount: 2,
            },
        ]

        const mergeData = mergeTrendData({
            data: list,
            startTime: '2021-08-06 00:00:00',
            endTime: '2021-08-07 00:00:00',
            fields: [
                //受理量
                {
                    name: "completeCount"
                },
                //告警量
                {
                    name: "alarmCount"
                },
                //健康度=（受理量-告警量） * 100
                {
                    name: "healthRate",
                    calcuate: (map, i) => {
                        const completeCount = map.completeCountArr[i];
                        const alarmCount = map.alarmCountArr[i];
                        let healthRate = ((completeCount - alarmCount) * 100).toFixed(2);
                        if (isNaN(healthRate)) {
                            healthRate = 0;
                        }
                        return healthRate;
                    }
                }
            ],
            scale: 60,
            labelTimeFormatter: (labelTime, index) => {
                return parseTime(labelTime, '{h}:{i}');
            },
            cycleTimeKey: 'cycleTime'
        })
        console.log(mergeData)

    
    </script>

    
</body>

</html>